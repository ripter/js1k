const WIDTH=312,WIDTH_FLOOR=32,HEIGHT=390,FRAME_LENGTH=10,FRAME_RATE=250,VPOINT={X:157,Y:215},NONE=!1,COIN='\uD83D\uDC8E',BOMB='\uD83D\uDCA3',RECT_TOP=0,RECT_LEFT=1,RECT_BOTTOM=2,RECT_RIGHT=3,ITEM_X=4,ITEM_Y=5;let lastTimestamp=-FRAME_RATE,isKeyDown=!1,canScore=!1,currentItem=COIN,score=0,lives=3,frame=10;const FRAMES=[[0,0,3,8,5,4],[3,8,5,16,10,10],[5,16,8,24,15,16],[8,24,11,32,20,24],[11,32,15,44,25,36],[15,44,19,58,30,48],[19,58,22,70,35,60],[22,70,29,90,40,75],[29,90,35,112,45,99],[35,112,45,140,50,122],[45,140,55,175,55,155]];console.log('Coin Miner 2018'),b.addEventListener('click',(a)=>{console.log(a),isKeyDown=!0}),b.addEventListener('touchend',(a)=>{console.log(a),isKeyDown=!0});function updateScore(){isKeyDown&&console.log('isKeyDown',isKeyDown,frame),isKeyDown&&frame===FRAMES.length-1&&(currentItem==COIN?(score+=1,c.fillStyle='rgba(0, 0, 255, .8)',c.fillRect(0,0,WIDTH,HEIGHT)):currentItem==BOMB&&(lives-=1,c.fillStyle='rgba(255, 0, 0, .8)',c.fillRect(0,0,WIDTH,HEIGHT)))}function renderHeader(){c.font='24px monospace',c.fillStyle='#f0f0b5';let a='';for(var d=0;d<lives;d++)a+='\uD83D\uDCA3';c.fillText(`ðŸ’Ž ${score}`,10,30),c.fillText(a,WIDTH-90,30)}function drawPlank(a){const d=VPOINT.X-WIDTH_FLOOR,e=VPOINT.X+WIDTH_FLOOR;c.beginPath(),c.moveTo(d-a[RECT_TOP],VPOINT.Y+a[RECT_LEFT]),c.lineTo(e+a[RECT_TOP],VPOINT.Y+a[RECT_LEFT]),c.lineTo(e+a[RECT_BOTTOM],VPOINT.Y+a[RECT_RIGHT]),c.lineTo(d-a[RECT_BOTTOM],VPOINT.Y+a[RECT_RIGHT]),c.lineTo(d-a[RECT_TOP],VPOINT.Y+a[RECT_LEFT]),c.fill(),c.stroke()}function tick(a=0){a=0|a;const d=0|a-lastTimestamp,e=FRAMES[frame];d>=FRAME_RATE&&(console.log('%cframe','color: #ddd;',frame),lastTimestamp=a,c.fillStyle='#725636',c.fillRect(0,0,WIDTH,HEIGHT),c.fillStyle='#000',c.beginPath(),c.arc(WIDTH/2,HEIGHT/2,WIDTH/2,0,1*Math.PI,!0),c.rect(0,HEIGHT/2,WIDTH,HEIGHT/2),c.fill(),updateScore(),renderHeader(),0>=lives&&c.fillText(`Game Over`,WIDTH/2-70,HEIGHT/2-25),c.fillStyle='#392b1b',c.lineWidth=1,drawPlank(e),currentItem!==NONE&&(c.font=`${12*frame}px serif`,c.fillText(currentItem,VPOINT.X-e[ITEM_X],VPOINT.Y+e[ITEM_Y])),c.strokeStyle='#7c8485',c.lineWidth=10,c.strokeRect(VPOINT.X-59,VPOINT.Y+40,4*WIDTH_FLOOR,4*WIDTH_FLOOR),frame+=1,frame===FRAMES.length&&(frame=0,currentItem=.5<Math.random()?COIN:BOMB,isKeyDown=!1)),0<lives&&!window.pause&&window.requestAnimationFrame(tick)}tick(),window.addEventListener('keydown',(a)=>{console.log(a),'Space'===a.code&&(a.shiftKey&&(frame-=2,0>frame&&(frame=FRAME_LENGTH)),console.log('skipping to frame',frame),requestAnimationFrame(tick))});