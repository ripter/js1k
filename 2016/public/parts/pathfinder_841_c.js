function attack(t,a,e){return rollDice("1d20+",t)>=e?rollDice(a):0}function battle(t,a){for(var e,s=[];t.hitpoitns>0&&a.hitpoitns>0&&(e=attack(t.attackBonus,t.damage,a.armorClass),a.hitpoitns-=e,0===e?s.push(template.miss(t.name)):s.push(template.hit(t.name,e)),s.push(template.status(a.name,a.hitpoitns)),!(a.hitpoitns<=0));)e=attack(a.attackBonus,a.damage,t.armorClass),t.hitpoitns-=e,0===e?s.push(template.miss(a.name)):s.push(template.hit(a.name,e)),s.push(template.status(t.name,t.hitpoitns));return a.hitpoitns<=0?s.push(template.die(a.name)):s.push(template.die(t.name)),s}var template={hit:function(t,a){return t+" hits for "+a+" damage."},miss:function(t){return t+" swings wildly and misses."},die:function(t){return t+" has been slain."},status:function(t,a){return t+" is down to "+a+" hitpoitns."}},text=battle(fighter,goblin);
